<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Understanding binstubs</title>
    <link rel="stylesheet" href="/style.css" type="text/css" media="screen" />
    <link type="text/css" rel="stylesheet" href="/syntax.css" />
    <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/Tigraine?format=xml" />
    <link rel="alternate" type="text/xml" title="RSS .92" href="http://feeds.feedburner.com/Tigraine?format=xml" />
    <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://feeds.feedburner.com/Tigraine?format=xml" />
    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <link rel="openid.delegate" href="http://tigraine.myopenid.com/" />
    <meta name="msapplication-task" content="name=Daniel on Twitter;action-uri=http://twitter.com/Tigraine" />
    <meta name="msapplication-task" content="name=Daniel on Facebook;action-uri=http://www.facebook.com/Tigraine" />
    <meta name="msapplication-starturl" content="./" />
    <meta name="application-name" content="Daniel Hoelbling's	Blog" />
    <meta name="msapplication-tooltip" content="Daniel Hoelbling's Blog" />
    <link rel='index' title='Tigraine' href='http://www.tigraine.at' />
    <script type="text/javascript">
        window.google_analytics_uacct = "UA-3272216-1";
    </script>
</head>
<body>
    <div id="container">
        <div id="blog_name">
            <a href="/">Tigraine</a></div>
        <div id="blog_slogan">
            Daniel Hoelbling talks about programming and technology</div>
        <div id="menu_view">
            <ul>
                <li><a href="">Home</a></li>
                <li class="page_item"><a href="/articles/" title="Articles">
                    Articles</a></li>
                <li class="page_item"><a href="/about-me/" title="About me">
                    About me</a></li>
            </ul>
        </div>
        <h1 id="header">
        </h1>
        <div id="wrapper">
            <div id="content">
                <div class="post">
    <!-- This is the posts header text -->
    <h2>
        <a href="/understanding-binstubs" rel="bookmark" title="Understanding binstubs">Understanding binstubs</a></h2>
    <!-- This is the date and author -->
    <small>January 05, 2013 by Daniel Hoelbling</small>
    <div class="entry">
        <p><i>This is an excerpt from the <a href="https://github.com/sstephenson/rbenv/wiki/Understanding-binstubs">Understanding binstubs</a> guide I wrote on the
<a href="https://github.com/sstephenson/rbenv/wiki">rbenv wiki</a>.</i></p>

<h2 id="project-specific-binstubs">Project-specific binstubs</h2>

<p>When you run <code>rspec</code> within your project’s directory, rbenv can ensure that it
will get executed with the Ruby version configured for that project. However,
nothing will ensure that the right <em>version of RSpec</em> gets activated; in fact,
RubyGems will simply activate the latest RSpec version even if your project
depends on an older version. In the context of a project, this is unwanted
behavior.</p>

<p>This is why <code>bundle exec &lt;command&gt;</code> is so often needed. It ensures the right
versions of dependencies get activated, ensuring a consistent ruby runtime
environment. However, <code>bundle exec</code> is a pain to always have to write.</p>

<h3 id="bundler-generated-binstubs">Bundler-generated binstubs</h3>

<p>Bundler can install binstubs in your project for all executables contained in
the current bundle.</p>

<pre><code>bundle install --binstubs
</code></pre>

<p>This creates, among others, <code>./bin/rspec</code> (simplified version shown):</p>

<div class="highlight"><pre><code class="rb"><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
<span class="c1"># Prepares the $LOAD_PATH by adding to it lib directories of all gems in the</span>
<span class="c1"># project&#39;s bundle:</span>
<span class="nb">require</span> <span class="s1">&#39;bundler/setup&#39;</span>
<span class="nb">load</span> <span class="no">Gem</span><span class="o">.</span><span class="n">bin_path</span><span class="p">(</span><span class="s1">&#39;rspec-core&#39;</span><span class="p">,</span> <span class="s1">&#39;rspec&#39;</span><span class="p">)</span>
</code></pre></div>

<p>RSpec can now be easily called with <code>bin/rspec</code>.</p>

<p>If you go one step further and prepend <code>./bin</code> to your $PATH, you can simply
call <code>rspec</code> instead of <code>bin/rspec</code>. This is recommended so that you are able to
launch RSpec the same way in a context of a project and outside of it.</p>

<h3 id="manually-created-binstubs">Manually created binstubs</h3>

<p>Now that you know that binstubs are simple scripts written in any language and
understand their purpose, you should consider creating own binstubs for your
project or your local development environment.</p>

<p>For instance, in the context of a Rails application, a manually generated
binstub to run Unicorn could be in <code>./bin/unicorn</code>:</p>

<div class="highlight"><pre><code class="rb"><span class="c1">#!/usr/bin/env ruby</span>
<span class="n">require_relative</span> <span class="s1">&#39;../config/boot&#39;</span>
<span class="nb">load</span> <span class="no">Gem</span><span class="o">.</span><span class="n">bin_path</span><span class="p">(</span><span class="s1">&#39;unicorn&#39;</span><span class="p">,</span> <span class="s1">&#39;unicorn&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Using <code>bin/unicorn</code> now ensures that Unicorn will run in the exact same
environment as the application: same Ruby version, same Gemfile dependencies.
This is true even if the binstub was called from outside the app, for instance
as <code>/path/to/app/current/bin/unicorn</code>.</p>

<h2 id="further-reading">Further reading</h2>

<ul>
  <li><a href="https://github.com/sstephenson/rbenv/wiki/Understanding-binstubs">Understanding binstubs</a> - full article on rbenv wiki</li>
  <li>
    <p><a href="https://github.com/sstephenson/rbenv/wiki/Unix-shell-initialization">Unix shell initialization</a> - useful facts about shell config files and
<code>$PATH</code></p>

  </li>
</ul>

    </div>
    <p class="postmetadata">
        <a href="/understanding-binstubs#comments"
            title="Comment on Understanding binstubs"><span
                class="dsq-postid" rel=" http://www.tigraine.at/understanding-binstubs/">View
                Comments</span> </a>
    </p>

    <!-- Disqus Comment System -->
    <a name="comments" />
    <div id="disqus_thread">
        <div id="dsq-content">
        </div>
    </div>
    <ul id="dsq-comments">
    </ul>
    <script type="text/javascript">
        var disqus_url = 'http://www.tigraine.at/understanding-binstubs/ ';
        var disqus_identifier = ' http://www.tigraine.at/understanding-binstubs/';
        var disqus_container_id = 'disqus_thread';
        var disqus_domain = 'disqus.com';
        var disqus_shortname = 'tigraine';
        var disqus_title = "Understanding binstubs";
        var disqus_config = function () {
            var config = this; // Access to the config object

            /* 
            All currently supported events:
            * preData — fires just before we request for initial data
            * preInit - fires after we get initial data but before we load any dependencies
            * onInit  - fires when all dependencies are resolved but before dtpl template is rendered
            * afterRender - fires when template is rendered but before we show it
            * onReady - everything is done
            */

            config.callbacks.preData.push(function () {
                // clear out the container (its filled for SEO/legacy purposes)
                document.getElementById(disqus_container_id).innerHTML = '';
            });
            config.callbacks.onReady.push(function () {
                // sync comments in the background so we don't block the page
                DISQUS.request.get('?cf_action=sync_comments&post_id=956');
            });
        };
    </script>
    <script type="text/javascript">
        var DsqLocal = {
            'trackbacks': [],
        };
    </script>
    <script type="text/javascript">
        (function () {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.' + disqus_domain + '/embed.js?pname=wordpress&pver=2.50';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <!-- End of Disqus Comment System -->
</div>

                <br />
                <br />
            </div>
        </div>
        <div id="sidebar">
            <br />
            <ul id="sidebar_main_menu">
                <li id="text-3" class="widget widget_text">
                    <div class="textwidget">
                        <p>
                            <a href="http://feeds2.feedburner.com/Tigraine" rel="alternate" type="application/rss+xml">
                                <img src="http://www.feedburner.com/fb/images/pub/feed-icon32x32.png" alt="" style="vertical-align: middle;
                                    border: 0" /></a>&nbsp;<a href="http://feeds2.feedburner.com/Tigraine" rel="alternate"
                                        type="application/rss+xml">Subscribe in a reader</a></p>
                    </div>
                </li>
                <li id="categories-1" class="widget widget_categories">
                    <h2 class="widgettitle">
                        Categories</h2>
                    <ul>
                        <li class="cat-item"><a href="/programmierung.html"
                            title="View all posts filed under Programming">Coding</a>
                            <ul class='children'>
                                <li class="cat-item"><a href="/net.html"
					title="View all posts filed under .NET">.NET</a> </li>
                                <li class="cat-item"><a href="/git.html"
                                    title="View all posts filed under Git">Git</a> </li>
                                <li class="cat-item">Projects
                                    <ul class='children'>
                                        <li class="cat-item"><a href="/dotless.html"
                                            title="View all posts filed under dotless">dotless</a> </li>
                                        <li class="cat-item"><a href="/elmsconnector.html"
                                            title="View all posts filed under elmsConnector">elmsConnector</a> </li>
                                        <li class="cat-item"><a href="/imagineclub-website.html"
                                            title="View all posts filed under imagineClub Website">imagineClub Website</a>
                                        </li>
                                        <li class="cat-item"><a href="/pandora.html"
                                            title="Posts about the Pandora Project (http://bitbucket.org/Tigraine/pandora-container/)">Pandora</a> </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li id="text-444566711" class="widget widget_text">
                    <h2 class="widgettitle">
                        Because I Care</h2>
                    <div class="textwidget">
						<a href='https://developer.mozilla.org/en/JavaScript' title='JS Documentation'><img src='http://static.jsconf.us/promotejsh.gif' height='150' width='180' alt='JS Documentation'/></a>
                        <img src="/images/altdotnet.png" alt="ALT.NET" />
                        <br />
                        <a href="http://testdriven.com/">
                            <img src="http://testdriven.com/programs/logotdsoft.png" border="0" alt="I'm test-driven!" /></a></div>
                </li>
                <li id="text-444566712" class="widget widget_text">
                    <h2 class="widgettitle">
                        Projects</h2>
                    <div class="textwidget">
                        <a href="http://www.dotlesscss.com">
                            <img src="/images/dotless-logo.jpg" alt="dynamic css for .NET" /></a></div>
                </li>
                <li id="linkcat-134" class="widget widget_links">
                    <h2 class="widgettitle">
                        Daniel</h2>
                    <ul class='xoxo blogroll'>
                        <li><a href="http://www.facebook.com/profile.php?id=1111490504&amp;ref=name" rel="me"
                            title="My Facebook page" target="_blank">@Facebook</a></li>
                        <li><a href="http://www.flickr.com/photos/15594453@N02/" title="Daniel Hoelbling">@Flickr</a></li>
                        <li><a href="http://www.linkedin.com/in/danielhoelbling" rel="me" title="My LinkedIn profile"
                            target="_blank">@LinkedIn</a></li>
                        <li><a href="http://twitter.com/tigraine" rel="me">@Twitter</a></li>
                    </ul>
                </li>
                <li id="text-213266941" class="widget widget_text">
                    <h2 class="widgettitle">
                        Search</h2>
                    <div class="textwidget">
                        <script type="text/javascript" src="http://www.lijit.com/informers/wijits?username=Tigraine&js=1"></script>
                        <a style='color: #999' href='http://www.lijit.com' id='lijit_wijit_pvs_link'>Lijit Search</a></div>
                </li>
                <li id="text-241688251" class="widget widget_text">
                    <div class="textwidget">
                        <br />
                        <br />
                        <a href="http://www.jetbrains.com/resharper/features/index.html?linklogos" style="position: relative;
                            display: block; width: 120px; height: 30px; border: 0; margin: 0; padding: 0;
                            text-decoration: none; text-indent: 0;"><span style="margin: 0; padding: 0; position: absolute;
                                top: -1px; left: 35px; font-size: 9px; cursor: pointer; background-image: none;
                                border: 0; color: #e9d5e1; font-family: trebuchet ms,arial,sans-serif; font-weight: normal;">
                                Can't live without</span>
                            <img src="http://www.jetbrains.com/resharper/features/rs/rs1/rs120x30_violet.gif"
                                alt="The Most Intelligent Add-In To Visual Studio" border="0" /></a></div>
                </li>
                <li id="text-315869281" class="widget widget_text">
                    <div class="textwidget">
                        <script type="text/javascript">
                            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
                            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
                        </script>
                        <script type="text/javascript">
                            try {
                                var pageTracker = _gat._getTracker("UA-3272216-1");
                                pageTracker._trackPageview();
                            } catch (err) { }</script>
                    </div>
                </li>
            </ul>
        </div>
        <hr id="clear" />
    </div>
    <div id="footer">
        <div id="footer_text">
            <br />
            &copy; Copyright 2010 Daniel H&ouml;lbling<br />
            This blog is powered by <a href="http://github.com/mojombo/jekyll/wiki">Jekyll</a>
        </div>
        <br />
    </div>
    <script type="text/javascript">
        var disqus_shortname = 'tigraine';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.src = 'http://disqus.com/forums/tigraine/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        } ());
    </script>
</body>
</html>
